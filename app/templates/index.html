<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sciences Trainer</title>

<style>
  /* =========================
     BASE
     ========================= */

  * {
    box-sizing: border-box;
  }

  body {
    font-family: monospace;
    background: #0e0e0e;
    color: #eee;
    padding: 16px;
    max-width: 700px;
    margin: 0 auto;
  }

  h1 {
    color: #ffd54f;
    font-size: 22px;
  }

  hr {
    border: none;
    border-top: 1px solid #333;
    margin: 16px 0;
  }

  /* =========================
     NAV
     ========================= */

  nav {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    margin-bottom: 8px;
  }

  nav a {
    color: #4fc3f7;
    text-decoration: none;
    font-size: 15px;
  }

  /* =========================
     FORM ELEMENTS
     ========================= */

  label {
    display: block;
    margin-top: 20px;
  }

  input,
  select,
  button {
    width: 100%;
    background: #222;
    color: #eee;
    border: 1px solid #555;
    font-family: monospace;
    padding: 10px;
    margin-top: 6px;
    font-size: 16px; /* evita zoom en móvil */
  }

  input[type="checkbox"],
  input[type="radio"] {
    width: auto;
    transform: scale(1.2);
    margin-right: 6px;
  }

  button {
    margin-top: 25px;
    cursor: pointer;
    font-size: 17px;
    padding: 12px;
  }

  /* =========================
     HELPERS
     ========================= */

  .hint {
    color: #aaa;
    font-size: 13px;
    margin-top: 6px;
    display: block;
  }

  .box {
    margin-top: 20px;
    padding: 12px;
    border: 1px solid #444;
    background: #141414;
  }

  /* =========================
     MOBILE REFINEMENT
     ========================= */

  @media (max-width: 480px) {
    body {
      padding: 12px;
    }

    h1 {
      font-size: 20px;
    }

    .box {
      padding: 12px;
    }
  }
</style>
</head>

<body>

<nav>
  <a href="/">Inicio</a>
  <a href="/admin">Admin</a>
</nav>

<hr>

<h1>Configurar sesión</h1>

<form method="post" action="/play/question">

  <!-- ========================= -->
  <!-- CATEGORÍA -->
  <!-- ========================= -->
  <label>Categoría</label>
  <select id="categorySelect" required>
    <option value="">-- Selecciona categoría --</option>
    {% for c in categories %}
      <option value="{{ c.id }}">{{ c.name }}</option>
    {% endfor %}
  </select>

  <!-- ========================= -->
  <!-- SUBCATEGORÍA -->
  <!-- ========================= -->
  <label>Subcategoría</label>
  <select name="subcategory_id" id="subcategorySelect" required>
    <option value="">-- Selecciona subcategoría --</option>
  </select>

  <!-- ========================= -->
  <!-- TODO EL BANCO -->
  <!-- ========================= -->
  <label>
    <input type="checkbox" name="all_questions" value="1">
    Usar todo el banco de preguntas
  </label>
  <span class="hint">
    Si se activa, se ignora el número de preguntas.
  </span>

  <!-- ========================= -->
  <!-- NÚMERO DE PREGUNTAS -->
  <!-- ========================= -->
  <label>Número de preguntas</label>
  <input
    type="number"
    name="limit"
    min="1"
    max="10000"
    value="20"
  >

  <!-- ========================= -->
  <!-- TIEMPO -->
  <!-- ========================= -->
  <label>Tiempo total (minutos)</label>
  <input
    type="number"
    name="time_limit"
    min="1"
    max="180"
    value="30"
    required
  >

  <!-- ========================= -->
  <!-- MODO -->
  <!-- ========================= -->
  <div class="box">
    <strong>Modo</strong>

    <label>
      <input type="radio" name="exam" value="" checked>
      Entrenamiento (feedback inmediato)
    </label>

    <label>
      <input type="radio" name="exam" value="1">
      Examen (solo resultado final)
    </label>

    <span class="hint">
      En modo examen no se muestran correcciones ni respuestas durante la prueba.
    </span>
  </div>

  <button>Empezar</button>

</form>

<!-- ========================= -->
<!-- JS: CATEGORÍA → SUBCATEGORÍA -->
<!-- ========================= -->
<script>
  const categoryData = {
    {% for c in categories %}
      "{{ c.id }}": [
        {% for s in c.subcategories %}
          { id: "{{ s.id }}", name: "{{ s.name }}" },
        {% endfor %}
      ],
    {% endfor %}
  };

  const categorySelect = document.getElementById("categorySelect");
  const subcategorySelect = document.getElementById("subcategorySelect");

  categorySelect.addEventListener("change", () => {
    const categoryId = categorySelect.value;

    subcategorySelect.innerHTML =
      '<option value="">-- Selecciona subcategoría --</option>';

    if (!categoryId || !categoryData[categoryId]) return;

    categoryData[categoryId].forEach(sub => {
      const option = document.createElement("option");
      option.value = sub.id;
      option.textContent = sub.name;
      subcategorySelect.appendChild(option);
    });
  });
</script>

</body>
</html>
